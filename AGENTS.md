# Agent Guide for ADL (Zig)

This repository contains the Source for ADL (Application Description Language), a Zig library for intermediate UI.

## 1. Build, Lint, and Test

### Build
- **Build Project:**
  ```bash
  zig build
  ```
- **Build specific step (if applicable):**
  Check `zig build --help` for available steps.

### Format & Lint
- **Format Code:**
  ```bash
  zig fmt .
  ```
  *Always run this before committing.*

### Test
- **Run All Tests:**
  ```bash
  zig build test
  ```
- **Run Specific Test Filter:**
  ```bash
  zig build test -- --test-filter "store: read"
  ```
  *(Note: This depends on the build.zig configuration passing args to the test artifact. If that doesn't work, run all tests.)*

- **Run Tests in a Single File (Standalone):**
  If the file has no complex module dependencies:
  ```bash
  zig test src/path/to/file.zig
  ```

## 2. Code Style & Conventions

### General
- **Language:** Zig (Latest stable or master as defined in `build.zig` environment).
- **Indentation:** 4 spaces.
- **Line Endings:** LF.

### Naming Conventions
- **Files:** `snake_case.zig` (e.g., `scroll_area.zig`, `raylib_backend.zig`).
- **Structs / Types:** `PascalCase` (e.g., `Store`, `UIContext`, `ComplexState`).
- **Functions:** `camelCase` (e.g., `init`, `getCopy`, `beginList`).
- **Variables / Arguments:** `snake_case` (e.g., `allocator`, `initial_state`, `id_str`).
- **Constants:**
  - If it's a type alias: `PascalCase` (e.g., `Self`, `ReadGuard`).
  - If it's a value: `camelCase` or `snake_case` (follow surrounding context, usually `camelCase` for public constants).

### Structs & Types
- Use `const Self = @This();` for self-reference inside structs.
- Expose generic types via functions returning types: `pub fn Store(comptime T: type) type { ... }`.
- Group related functionality in structs acting as namespaces (e.g., `pub const UI = struct { ... }`).

### Memory Management
- **Explicit Allocators:** Pass `allocator: std.mem.Allocator` to `init` functions if allocation is needed.
- **Deinitialization:** Provide a `pub fn deinit(self: *Self) void` method.
- **Guards:** For locks or temporary resources, use the guard pattern with `release()` methods (e.g., `const guard = store.read(); defer guard.release();`).

### Error Handling
- Use error unions `!T` for return types that can fail.
- Use `try` to bubble up errors.
- Use `catch` only when handling the error explicitly.

### Imports
- Group imports:
  1. Standard Library: `const std = @import("std");`
  2. Third-party Dependencies: `const cl = @import("zclay");`
  3. Internal Modules: `const context = @import("core/context.zig");`
- Use relative paths for internal imports where appropriate, or root-relative if cleaner.

### Documentation
- Use `//!` for top-level module documentation.
- Use `///` for public function and struct documentation.
- Use Markdown within documentation comments.

### Testing
- Place `test "description" { ... }` blocks within the source file (usually at the bottom or near relevant code).
- Use `std.testing` for assertions (e.g., `try std.testing.expectEqual(a, b);`).
- Use `std.testing.allocator` for tests.

## 3. Project Structure
- `src/`: Source code.
  - `root.zig`: Main entry point for the library.
  - `ui/`: UI components and systems.
  - `store.zig`: State management.
  - `backends/`: Backend implementations (e.g., Raylib).
- `build.zig`: Build configuration.
- `examples/`: Example usage code.

---
*Generated by opencode*
